def hora = new Date()

pipeline{
  agent any
  stages{
    stage("Hora"){
      steps{
        println "Son las: ${hora}."
        script{

          def a = 13
          if (a > 12){
            println "Hora despues de las 12, se ejecuta stage"
            BUILD_TRIGGER_BY = "${currentBuild.getBuildCauses()[0].shortDescription} / ${currentBuild.getBuildCauses()[0].userId}"
            echo "BUILD_TRIGGER_BY: ${BUILD_TRIGGER_BY}"
            wrap([$class: 'BuildUser']) {
              USER = "${BUILD_USER}"
              USER_ID = "${BUILD_USER_ID}"
            }
            echo "BUILD_TRIGGER_BY: ${BUILD_USER} / ${BUILD_USER_ID}"
            println "Version de java instalada en el equipo:"
            javaver('Output')
          } else {
            println "Hora antes de las 12, saltamos ejecucion"
          }
        }
      }
    }
  }
}

def javaver(String version){
  bat "java -version"
  echo version
}
