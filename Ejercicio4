now = LocalTime.now() // or LocalDateTime
def hora = new Date()
def userid = env.BUILD_USER_ID
def user = env.BUILD_USER

pipeline{
  agent any
  stages{
    stage("Hora"){
      steps{
        println "Son las: ${hora}."
        script{
          println SV(now.hour, now.minute, now.second)
          (H, M, S) = now[HOUR_OF_DAY, MINUTE_OF_HOUR, SECOND_OF_MINUTE]
          printf 'The time is %02d:%02d:%02d\n', H, M, S
        
          def a = 13
          if (a > 12){
            println "Hora despues de las 12, se ejecuta stage"
            BUILD_TRIGGER_BY = "${currentBuild.getBuildCauses()[0].shortDescription} / ${currentBuild.getBuildCauses()[0].userId}"
            echo "BUILD_TRIGGER_BY: ${BUILD_TRIGGER_BY}"
            println "Version de java instalada en el equipo:"
            javaver('Output')
          } else {
            println "Hora antes de las 12, saltamos ejecucion"
          }
        }
      }
    }
  }
}

def javaver(String version){
  bat "java -version"
  echo version
}
